import numpy as np

# Example PPM
#ppm = np.array([
#    [0.8, 0.1, 0.05, 0.05],
#    [0.2, 0.3, 0.4, 0.1],
#    [0.1, 0.1, 0.7, 0.1],
#    [0.25, 0.25, 0.25, 0.25]
#])

ppm_PRTE = np.array([
    [0.000000, 0.526882, 0.064516, 0.408602],
    [0.000000, 0.204301, 0.021505, 0.774194],
    [0.010753, 0.376344, 0.000000, 0.612903],
    [0.000000, 0.537634, 0.000000, 0.462366],
    [0.053763, 0.870968, 0.000000, 0.075269],
    [0.000000, 0.000000, 0.000000, 1.000000],
    [0.000000, 0.182796, 0.000000, 0.817204],
    [0.000000, 0.290323, 0.000000, 0.709677],
    [0.000000, 0.720430, 0.021505, 0.258065],
    [0.075269, 0.419355, 0.139785, 0.365591],
    [0.086022, 0.451613, 0.268817, 0.193548],
    [0.129032, 0.279570, 0.139785, 0.451613],
    [0.000000, 0.301075, 0.387097, 0.311828],
    [0.086022, 0.419355, 0.161290, 0.333333],
    [0.118280, 0.322581, 0.182796, 0.376344]
])

ppm_CERT = np.array([
    [0.150000, 0.200000, 0.475000, 0.175000],
    [0.000000, 0.775000, 0.200000, 0.025000],
    [0.175000, 0.650000, 0.175000, 0.000000],
    [0.000000, 0.075000, 0.450000, 0.475000],
    [0.000000, 1.000000, 0.000000, 0.000000],
    [0.000000, 0.350000, 0.425000, 0.225000],
    [0.000000, 1.000000, 0.000000, 0.000000],
    [0.150000, 0.425000, 0.200000, 0.225000],
    [0.000000, 0.225000, 0.775000, 0.000000],
    [0.000000, 0.875000, 0.000000, 0.125000],
    [0.000000, 0.675000, 0.200000, 0.125000],
    [0.075000, 0.275000, 0.425000, 0.225000],
    [0.000000, 0.725000, 0.275000, 0.000000],
    [0.025000, 0.900000, 0.000000, 0.075000],
    [0.150000, 0.275000, 0.375000, 0.200000]
])


# Nucleotides
nucleotides = ['A', 'C', 'G', 'T']
iupac_codes = {
    'A': 'A', 'C': 'C', 'G': 'G', 'T': 'T',
    'AC': 'M', 'AG': 'R', 'AT': 'W', 'CG': 'S',
    'CT': 'Y', 'GT': 'K', 'ACG': 'V', 'ACT': 'H',
    'AGT': 'D', 'CGT': 'B', 'ACGT': 'N'
}

# Function to get consensus sequence
def ppm_to_consensus(ppm):
    consensus = []
    for position in ppm:
        max_prob = np.max(position)
        bases = [nucleotides[i] for i, prob in enumerate(position) if prob == max_prob]
        consensus.append(iupac_codes[''.join(sorted(bases))])
    return ''.join(consensus)

# Get consensus sequence
consensus_sequence = ppm_to_consensus(ppm_PRTE)
print("Consensus Sequence for PRTE :", consensus_sequence)
consensus_sequence = ppm_to_consensus(ppm_CERT)
print("Consensus Sequence for CERT :", consensus_sequence)


